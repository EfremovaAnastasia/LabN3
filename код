import java.util.Scanner;
class Books{
    private String author;
    private String title;
    private int pages;
    private static int bookCounter = 0;
    private int bookNumber;
    private static int maxBooks = 10;
    public Books() {
    }
    public static void setMaxBooks(int max) {
        maxBooks = max;
        System.out.println("Лимит книг установлен: " + max);
    }
    public static int getMaxBooks() {
        return maxBooks;
    }
    public static boolean canAddBook() {
        return bookCounter < maxBooks;
    }
    public static Books createBook(String author, String title, int pages) {
        if (canAddBook()) {
            Books newBook = new Books(author, title, pages);
            System.out.println("Книга \"" + title + "\" добавлена успешно!");
            System.out.println("Текущее количество: " + bookCounter + "/" + maxBooks);
            return newBook;
        } else {
            System.out.println("Превышен лимит книг (" + maxBooks + ").");
            return null;
        }
    }
    private Books(String author, String title, int pages) {
        this.author = author;
        this.title = title;
        this.pages = pages;
        this.bookNumber = ++bookCounter;
    }
    @Override
    public String toString() {
        return bookNumber + "." + " " + author + " " + "\"" + title + "\"" + "." + " " + "Объём:" + " " + pages + " " + "страниц.";
    }
    public String getAuthor() {
        return author;
    }
    public int getPages() {
        return pages;
    }
    public static int getBookCounter(){
        return bookCounter;
    }
    public static int countBooks(String author, Books[] booksArray) {
        int count = 0;
        for (Books book : booksArray) {
            if ((book != null) && (book.getAuthor().equals(author))) {
                count++;
            }
        }
        return count;
    }
    public static int countPages(String author, Books[] booksArray) {
        int count = 0;
        for (Books book : booksArray) {
            if ((book != null) && (book.getAuthor().equals(author))) {
                count += book.pages;
            }
        }
        return count;
    }
    public static int countAuthors(Books[] booksArray) {
        int count = 0;
        for (int i = 0; i < booksArray.length; i++) {
            if (booksArray[i] == null)
                continue;
            int s = 1;
            for (int j = 0; j < i; j++) {
                if ((booksArray[j] != null) && (booksArray[i].getAuthor().equals(booksArray[j].getAuthor()))) {
                    s = 0;
                    break;
                }
            }
            if (s == 1) {
                count++;
            }
        }
        return count;
    }
    public static String getAuthorByIndex(int index, Books[] booksArray) {
        int uniqueIndex = 0;
        for (int i = 0; i < booksArray.length; i++) {
            if (booksArray[i] == null)
                continue;
            int y = 1;
            for (int j = 0; j < i; j++) {
                if ((booksArray[j] != null) && (booksArray[i].getAuthor().equals(booksArray[j].getAuthor()))) {
                    y = 0;
                    break;
                }
            }
            if (y == 1) {
                if (uniqueIndex == index) {
                    return booksArray[i].getAuthor();
                }
                uniqueIndex++;
            }
        }
        return null;
    }
    public static String[] listAuthors(Books[] booksArray) {
        int uniqueCount = countAuthors(booksArray);
        String[] res = new String[uniqueCount];
        for (int k = 0; k < uniqueCount; k++) {
            res[k] = getAuthorByIndex(k, booksArray);
        }
        return res;
    }
    public void printAuthorsInfo(Books[] booksArray) {
        int uniqueAuthors = countAuthors(booksArray);
        for (int i = 0; i < uniqueAuthors; i++) {
            String author = getAuthorByIndex(i, booksArray);
            int booksCount = countBooks(author, booksArray);
            int pagesCount = countPages(author, booksArray);
            System.out.println("Автор: " + author +
                    ". Количество книг: " + booksCount +
                    ". Объем страниц: " + pagesCount + ".");
        }
    }
    public static int averageOfPages(Books[] booksArray) {
        int count = 0;
        int v = 0;
        for (Books book : booksArray) {
            if (book != null) {
                count += book.getPages();
                v++;
            }
        }
        if (v > 0)
            return count / v;
        else
            return 0;
    }
    public static int averageOfPagesAuthor(String author, Books[] booksArray) {
        int count = 0;
        int k = 0;
        for (Books book : booksArray) {
            if ((book != null) && (book.getAuthor().equals(author))) {
                count += book.pages;
                k++;
            }
        }
        if (k > 0)
            return count / k;
        else
            return 0;
    }
    public static String authorMostBooks(Books[] booksArray) {
        String[] authors = listAuthors(booksArray);
        String maxAuthor = "";
        int maxBooks = 0;
        for (String author : authors) {
            if (author != null) {
                int booksCount = countBooks(author, booksArray);
                if (booksCount > maxBooks) {
                    maxBooks = booksCount;
                    maxAuthor = author;
                }
            }
        }
        return maxAuthor;
    }
    public static String authorMostPages(Books[] booksArray) {
        String[] authors = listAuthors(booksArray);
        String maxAuthor = "";
        int maxPages = 0;
        for (String author : authors) {
            if (author != null) {
                int pagesCount = countPages(author, booksArray);
                if (pagesCount > maxPages) {
                    maxPages = pagesCount;
                    maxAuthor = author;
                }
            }
        }
        return maxAuthor;
    }
    public static String comparisonMostPagesAndMostBooks(Books[] booksArray){
        String mostPages = authorMostPages(booksArray);
        String mostBooks = authorMostBooks(booksArray);
        if ((mostPages == null) || (mostBooks == null)) {
            return "NO";
        }
        if (mostPages.equals(mostBooks))
            return "YES";
        else
            return "NO";
    }
}
            return "NO";
    }
}
}
